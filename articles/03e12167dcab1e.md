---
title: "now in androidã§Roborazziã¯ã©ã®ã‚ˆã†ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹"
emoji: "ğŸ“±"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Android, test, jetpackcompose]
published: false
---

# ã¯ã˜ã‚ã«

æœ€è¿‘ã€Android ã®ãƒ†ã‚¹ãƒˆã«ã¤ã„ã¦èˆˆå‘³ãŒé«˜ã¾ã£ã¦ãŠã‚Šè‰²ã€…èª¿ã¹ã¦ã„ã¾ã™ sanao ã¨ç”³ã—ã¾ã™ã€‚
[Roborazzi](https://github.com/takahirom/roborazzi)ã¨ã¯ã€[@takahirom](https://twitter.com/new_runnable)æ°ã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚Œã¦ã„ã‚‹ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ†ã‚¹ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™(ç§ã‚‚åœ°å‘³ã« Contribute ã—ã¦ã‚‹ãœ)ã€‚
ãã®æœ‰ç”¨æ€§ã‹ã‚‰ã€[now in android](https://github.com/android/nowinandroid) ã«ã‚‚ 2023 å¹´å¤ã”ã‚ã«æ¡ç”¨ã•ã‚Œã¾ã—ãŸ[^1]ã€‚
æœ¬è¨˜äº‹ã§ã¯ now in android å†…ã§ Roborazzi ãŒã©ã®ã‚ˆã†ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ã®ã‹ã–ã£ãã‚Šã¨èª¬æ˜ã—ã¾ã™ã€‚
ãªãŠã€ã¾ã ã¾ã  now in android ã§ã¯ Roborazzi ã®å°å…¥ãŒé€²ã‚€ã“ã¨ãŒäºˆæƒ³ã•ã‚Œã¾ã™ã®ã§ã€åŸ·ç­†æ™‚ç‚¹(2024/2/6)ã§ã®æƒ…å ±ã ã¨ã„ã†ã“ã¨ã«ã”æ³¨æ„ãã ã•ã„ã€‚

### æœ¬è¨˜äº‹ã§ã¯èª¬æ˜ã—ãªã„ã“ã¨

- Roborazzi ã‚’æ¡ç”¨ã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆ
- Roborazzi ã®ä½¿ã„æ–¹

# ä½¿ç”¨ç®‡æ‰€

ç¾åœ¨ã€Roborazzi ãŒé…ç½®ã•ã‚Œã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯

- core/testing
- core/designsystem
- app
- feature/foryou

ã«ãªã‚Šã¾ã™ã€‚

## core/testing

core/testing ã§ã¯ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ã‚·ãƒ¥ãƒƒã¨æ’®ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ãªã©ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚
ã‚‚ã£ã¨ã‚‚ã‚ˆãä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹é–¢æ•°ãŒ`captureMultiTheme`ã§ã™ã€‚
https://github.com/android/nowinandroid/blob/3ff5d48f3739c2341bfb288779e35ff444015783/core/testing/src/main/kotlin/com/google/samples/apps/nowinandroid/core/testing/util/ScreenshotHelper.kt#L94-L101
`captureMultiTheme`ã¯

- å‡ºåŠ›ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«å
- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‹
- ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ã‚«ãƒ©ãƒ¼ã‚’ä½¿ã†ã‹
- Android ãƒ†ãƒ¼ãƒã‚’ä½¿ã†ã‹

ã‚’å¼•æ•°ã‚’å¤‰ãˆã‚‹ã ã‘ã§æŸ”è»Ÿã«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®å½±ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã¾ãŸã€ç¾çŠ¶ã®ä½¿ç”¨é »åº¦ã¯å°‘ãªã„ã§ã™ãŒã€ãƒ‡ãƒã‚¤ã‚¹ã”ã¨ã«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã™ã‚‹é–¢æ•°ã‚‚ã‚ã‚Šã¾ã™ã€‚
ã¾ãšã€ãŸã ã²ã¨ã¤ã®ãƒ‡ãƒã‚¤ã‚¹ã§ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®å½±ã™ã‚‹ãŸã‚ã®`captureForDevice`é–¢æ•°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚
https://github.com/android/nowinandroid/blob/3ff5d48f3739c2341bfb288779e35ff444015783/core/testing/src/main/kotlin/com/google/samples/apps/nowinandroid/core/testing/util/ScreenshotHelper.kt#L61-L68

`captureForDevice`ã®å¼•æ•°`deviceSpec: String` ã¯æ¬¡ã®ã‚ˆã†ã«ä½¿ã†ã¨ã„ã„ã§ã—ã‚‡ã†ã€‚

```kotlin
composeTestRule.captureForDevice(
            deviceName = "phone_dark",
            deviceSpec = DefaultTestDevices.PHONE.spec,
            ...
```

`DefaultTestDevices` åˆ—æŒ™å‹ã¯ã‚ã‚‰ã‹ã˜ã‚å®šç¾©ã—ã¦ã‚ã‚‹ã‚¹ãƒãƒ›ã€æŠ˜ã‚ŠãŸãŸã¿ãƒ‡ãƒã‚¤ã‚¹ã€ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã®é«˜ã•ã‚„å¹…ãªã©ã®ã‚¹ãƒšãƒƒã‚¯ã§ã™ã€‚
ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚
https://github.com/android/nowinandroid/blob/3ff5d48f3739c2341bfb288779e35ff444015783/core/testing/src/main/kotlin/com/google/samples/apps/nowinandroid/core/testing/util/ScreenshotHelper.kt#L47-L51

ã¾ãŸã€`DefaultTestDevices` ã‚’ç”¨ã„ã¦ã‚¹ãƒãƒ›ã€æŠ˜ã‚ŠãŸãŸã¿ãƒ‡ãƒã‚¤ã‚¹ã€ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã®å…¨ã¦ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®å½±ã™ã‚‹é–¢æ•° `captureMultiDevice` ã‚‚å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚
https://github.com/android/nowinandroid/blob/3ff5d48f3739c2341bfb288779e35ff444015783/core/testing/src/main/kotlin/com/google/samples/apps/nowinandroid/core/testing/util/ScreenshotHelper.kt#L52-L59

## app

[NiaAppScreenSizesScreenshotTests.kt](https://github.com/android/nowinandroid/blob/3ff5d48f3739c2341bfb288779e35ff444015783/app/src/testDemo/kotlin/com/google/samples/apps/nowinandroid/ui/NiaAppScreenSizesScreenshotTests.kt) ã«ã¦ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
ãƒ†ãƒ¼ãƒã¯é–¢ä¿‚ãªãã€ã²ãŸã™ã‚‰è‰²ã‚“ãªå¹…ã‚„é«˜ã•ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®ã£ã¦ã„ã¾ã™ã€‚
ã“ã“ã§`captureMultiDevice`ã‚’ä½¿ã‚ãªã‹ã£ãŸç†ç”±ã¨ã—ã¦ã¯ï¼“ã¤ã®ãƒ‡ãƒã‚¤ã‚¹ã®ã‚¹ãƒšãƒƒã‚¯ã ã‘ã§ãªãã„ã‚ã„ã‚ãªé«˜ã•ã‚„å¹…ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®å½±ã™ã‚‹ãŸã‚ã ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚

# è„šæ³¨

[^1]: è©²å½“ [PR](https://github.com/android/nowinandroid/pull/876)
